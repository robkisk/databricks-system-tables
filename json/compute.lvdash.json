{
  "datasets": [
    {
      "name": "ab02dd6c",
      "displayName": "CPU Utilization",
      "queryLines": [
        "WITH per_minute_utilization AS (\n",
        "  SELECT\n",
        "    cluster_name,\n",
        "    c.workspace_id,\n",
        "    c.cluster_id,\n",
        "    driver,\n",
        "    start_time,\n",
        "    avg(cpu_user_percent + cpu_system_percent) as cpu_utilization,\n",
        "    avg(mem_used_percent) as memory_utilization,\n",
        "    avg(mem_swap_percent) as swap_utilization\n",
        "  FROM system.compute.node_timeline\n",
        "  JOIN system.compute.clusters c ON c.cluster_id = node_timeline.cluster_id\n",
        "  GROUP BY cluster_name, c.cluster_id, start_time, driver, c.workspace_id\n",
        ")\n",
        "\n",
        "SELECT\n",
        "    CONCAT(\n",
        "    '<a href=\"/compute/clusters/',\n",
        "    CAST(cluster_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    cluster_name,\n",
        "    '</a>'\n",
        "  ) AS cluster_name,\n",
        "  cluster_id,\n",
        "  avg(cpu_utilization) filter (where not driver) as `Avg Worker CPU Utilization`,\n",
        "  avg(cpu_utilization) filter (where driver) as `Avg Driver CPU Utilization`,\n",
        "  CASE\n",
        "    WHEN avg(cpu_utilization) < 50 THEN 'Underutilized'\n",
        "    WHEN avg(cpu_utilization) > 80 THEN 'Overutilized'\n",
        "    ELSE 'Normal'\n",
        "  END AS utilization_status\n",
        "FROM\n",
        "  per_minute_utilization\n",
        "WHERE \n",
        "  cluster_id IS NOT NULL AND 'Avg CPU Utilization' is not null\n",
        "GROUP BY\n",
        "  cluster_name, cluster_id, workspace_id"
      ]
    },
    {
      "name": "4acfabb6",
      "displayName": "Job Run Failure Analysis",
      "queryLines": [
        "SELECT \n",
        "  CONCAT(\n",
        "    '<a href=\"https://e2-spog.staging.cloud.databricks.com/#job/',\n",
        "    CAST(tl.job_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    name,\n",
        "    '</a>'\n",
        "  ) AS job_name,\n",
        "  tl.job_id,\n",
        "  COUNT(*) AS total_runs,\n",
        "  SUM(CASE WHEN result_state = 'FAILED' THEN 1 ELSE 0 END) AS failed_runs,\n",
        "  COUNT (*) - SUM(CASE WHEN result_state = 'FAILED' THEN 1 ELSE 0 END) AS successful_runs,\n",
        "  ROUND(100.0 * SUM(CASE WHEN result_state = 'FAILED' THEN 1 ELSE 0 END) / COUNT(*), 2) AS failure_rate_percent,\n",
        "  MAX(period_start_time) AS last_failure_time,\n",
        "  tl.workspace_id,\n",
        "  tl.account_id\n",
        "FROM \n",
        "  system.lakeflow.job_run_timeline tl\n",
        "JOIN system.lakeflow.jobs ON tl.job_id = jobs.job_id\n",
        "WHERE \n",
        "  period_start_time >= current_timestamp() - INTERVAL 7 DAYS\n",
        "GROUP BY \n",
        "  name, \n",
        "  tl.job_id,\n",
        "  tl.workspace_id,\n",
        "  tl.account_id\n",
        "HAVING \n",
        "  SUM(CASE WHEN result_state = 'FAILED' THEN 1 ELSE 0 END) > 10\n",
        "  AND ROUND(100.0 * SUM(CASE WHEN result_state = 'FAILED' THEN 1 ELSE 0 END) / COUNT(*), 2) >= 50\n",
        "ORDER BY \n",
        "  failure_rate_percent DESC\n",
        "LIMIT 20"
      ]
    },
    {
      "name": "eab7bfd1",
      "displayName": "Memory Utilization",
      "queryLines": [
        "WITH per_minute_utilization AS (\n",
        "  SELECT\n",
        "    cluster_name,\n",
        "    c.workspace_id,\n",
        "    c.cluster_id,\n",
        "    driver,\n",
        "    start_time,\n",
        "    avg(cpu_user_percent + cpu_system_percent) as cpu_utilization,\n",
        "    avg(mem_used_percent) as memory_utilization,\n",
        "    avg(mem_swap_percent) as swap_utilization\n",
        "  FROM system.compute.node_timeline\n",
        "  JOIN system.compute.clusters c ON c.cluster_id = node_timeline.cluster_id\n",
        "  GROUP BY cluster_name, c.cluster_id, start_time, driver, c.workspace_id\n",
        ")\n",
        "\n",
        "SELECT\n",
        "    CONCAT(\n",
        "    '<a href=\"/compute/clusters/',\n",
        "    CAST(cluster_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    cluster_name,\n",
        "    '</a>'\n",
        "  ) AS cluster_name,\n",
        "  cluster_id,\n",
        "  avg(memory_utilization) filter (where not driver) as `Avg Worker Memory Utilization`,\n",
        "  avg(memory_utilization) filter (where driver) as `Avg Driver Memory Utilization`,\n",
        "  CASE\n",
        "    WHEN avg(memory_utilization) < 50 THEN 'Underutilized'\n",
        "    WHEN avg(memory_utilization) > 80 THEN 'Overutilized'\n",
        "    ELSE 'Normal'\n",
        "  END AS utilization_status\n",
        "FROM\n",
        "  per_minute_utilization\n",
        "WHERE \n",
        "  cluster_id IS NOT NULL AND memory_utilization IS NOT null\n",
        "GROUP BY\n",
        "  cluster_name, cluster_id, workspace_id"
      ]
    },
    {
      "name": "d82de996",
      "displayName": "DBR Version",
      "queryLines": [
        "-- Step 1: Define clusters and embed cluster page links\n",
        "WITH cluster_versions AS (\n",
        "  SELECT\n",
        "      CONCAT(\n",
        "    '<a href=\"/compute/clusters/',\n",
        "    CAST(c.cluster_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(c.workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    c.cluster_name,\n",
        "    '</a>'\n",
        "  ) AS cluster_name,\n",
        "    cluster_id,\n",
        "    dbr_version,\n",
        "    workspace_id,\n",
        "    account_id,\n",
        "    owned_by,\n",
        "    create_time,\n",
        "    delete_time,\n",
        "    tags\n",
        "  FROM\n",
        "    system.compute.clusters c\n",
        "  GROUP BY\n",
        "    cluster_id, cluster_name, dbr_version, workspace_id, account_id, owned_by, create_time, delete_time, tags\n",
        "),\n",
        "\n",
        "-- Step 2: Filter for outdated DBR versions\n",
        "unsupported_clusters AS (\n",
        "  SELECT *\n",
        "  FROM cluster_versions\n",
        "  WHERE NOT (\n",
        "    dbr_version RLIKE '.*17\\\\.0.*' OR\n",
        "    dbr_version RLIKE '.*16\\\\.4.*' OR\n",
        "    dbr_version RLIKE '.*16\\\\.2.*' OR\n",
        "    dbr_version RLIKE '.*15\\\\.4.*' OR\n",
        "    dbr_version RLIKE '.*14\\\\.3.*' OR\n",
        "    dbr_version RLIKE '.*13\\\\.3.*' OR\n",
        "    dbr_version RLIKE '.*12\\\\.2.*' OR\n",
        "    dbr_version RLIKE '.*11\\\\.3.*'\n",
        "  )\n",
        "),\n",
        "\n",
        "-- Step 3: Calculate spend from system.billing.usage\n",
        "cluster_spend AS (\n",
        "  SELECT\n",
        "    usage_metadata.cluster_id,\n",
        "    workspace_id,\n",
        "    SUM(usage_quantity * list_prices.pricing.default) AS list_cost\n",
        "  FROM system.billing.usage u\n",
        "  INNER JOIN system.billing.list_prices list_prices\n",
        "    ON u.cloud = list_prices.cloud\n",
        "    AND u.sku_name = list_prices.sku_name\n",
        "    AND u.usage_start_time >= list_prices.price_start_time\n",
        "    AND (u.usage_end_time <= list_prices.price_end_time OR list_prices.price_end_time IS NULL)\n",
        "  WHERE u.usage_date >= CURRENT_DATE() - INTERVAL 30 DAY\n",
        "    AND u.usage_metadata.cluster_id IS NOT NULL\n",
        "  GROUP BY usage_metadata.cluster_id, workspace_id\n",
        ")\n",
        "\n",
        "-- Step 4: Join and return top 30 outdated clusters by cost\n",
        "SELECT\n",
        "  uc.cluster_name,\n",
        "  uc.cluster_id,\n",
        "  uc.dbr_version,\n",
        "  uc.workspace_id,\n",
        "  uc.account_id,\n",
        "  uc.owned_by,\n",
        "  uc.create_time,\n",
        "  uc.delete_time,\n",
        "  uc.tags,\n",
        "  CONCAT('$', FORMAT_NUMBER(ROUND(cs.list_cost, 2), 2)) AS list_cost\n",
        "FROM unsupported_clusters uc\n",
        "JOIN cluster_spend cs\n",
        "  ON uc.cluster_id = cs.cluster_id AND uc.workspace_id = cs.workspace_id\n",
        "ORDER BY cs.list_cost DESC\n",
        "LIMIT 30;"
      ]
    },
    {
      "name": "4c82fb4e",
      "displayName": "Job Run Failure Analysis 2",
      "queryLines": [
        "SELECT * FROM system.lakeflow.job_run_timeline WHERE result_state IS NOT NULL AND period_start_time >= NOW() - INTERVAL 6 MONTH;"
      ]
    },
    {
      "name": "7700ca5e",
      "displayName": "Most Expensive Jobs Last 30 Days",
      "queryLines": [
        "WITH list_cost_per_job AS (\n",
        "  SELECT\n",
        "    t1.workspace_id,\n",
        "    t1.usage_metadata.job_id,\n",
        "    COUNT(DISTINCT t1.usage_metadata.job_run_id) AS runs,\n",
        "    SUM(t1.usage_quantity * list_prices.pricing.default) AS list_cost,\n",
        "    FIRST(identity_metadata.run_as, TRUE) AS run_as_email,\n",
        "    FIRST(t1.custom_tags, TRUE) AS custom_tags,\n",
        "    MAX(t1.usage_end_time) AS last_seen_date\n",
        "  FROM system.billing.usage t1\n",
        "  INNER JOIN system.billing.list_prices list_prices\n",
        "    ON t1.cloud = list_prices.cloud\n",
        "    AND t1.sku_name = list_prices.sku_name\n",
        "    AND t1.usage_start_time >= list_prices.price_start_time\n",
        "    AND (t1.usage_end_time <= list_prices.price_end_time OR list_prices.price_end_time IS NULL)\n",
        "  WHERE\n",
        "    t1.sku_name LIKE '%JOBS%'\n",
        "    AND t1.usage_metadata.job_id IS NOT NULL\n",
        "    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAY\n",
        "  GROUP BY ALL\n",
        "),\n",
        "\n",
        "most_recent_jobs AS (\n",
        "  SELECT \n",
        "    *, \n",
        "    ROW_NUMBER() OVER(PARTITION BY workspace_id, job_id ORDER BY change_time DESC) AS rn\n",
        "  FROM system.lakeflow.jobs\n",
        "  QUALIFY rn = 1\n",
        ")\n",
        "\n",
        "SELECT \n",
        "  CONCAT(\n",
        "    '<a href=\"/jobs/',\n",
        "    CAST(t1.job_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(t1.workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    t1.job_id,\n",
        "    '</a>'\n",
        "  ) AS job_name,\n",
        "  t1.job_id,\n",
        "  t1.workspace_id,\n",
        "  t1.runs,\n",
        "  t1.run_as_email,\n",
        "  ROUND(SUM(list_cost), 2) AS list_cost,\n",
        "  t1.last_seen_date\n",
        "FROM list_cost_per_job t1\n",
        "LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n",
        "JOIN system.access.workspaces_latest w1 ON t1.workspace_id = w1.workspace_id\n",
        "GROUP BY ALL\n",
        "ORDER BY list_cost DESC\n",
        "LIMIT 30;\n",
        "\n"
      ]
    },
    {
      "name": "9247958f",
      "displayName": "10 Lowest CPU",
      "queryLines": [
        "WITH latest_cluster_names AS (\n",
        "  SELECT\n",
        "    cluster_id,\n",
        "    cluster_name,\n",
        "    ROW_NUMBER() OVER (PARTITION BY cluster_id ORDER BY change_time DESC) AS rn\n",
        "  FROM system.compute.clusters\n",
        ")\n",
        "\n",
        "SELECT\n",
        "  nt.cluster_id,\n",
        "  cl.cluster_name,\n",
        "  AVG(cpu_user_percent + cpu_system_percent) AS `Avg CPU Utilization`,\n",
        "  AVG(mem_used_percent) AS `Avg Memory Utilization`,\n",
        "  CASE\n",
        "    WHEN AVG(cpu_user_percent + cpu_system_percent) < 50 OR AVG(mem_used_percent) < 50 THEN 'Underutilized'\n",
        "    WHEN AVG(cpu_user_percent + cpu_system_percent) > 80 OR AVG(mem_used_percent) > 80 THEN 'Overutilized'\n",
        "    ELSE 'Normal'\n",
        "  END AS utilization_status\n",
        "FROM\n",
        "  system.compute.node_timeline nt\n",
        "LEFT JOIN (\n",
        "  SELECT cluster_id, cluster_name\n",
        "  FROM latest_cluster_names\n",
        "  WHERE rn = 1\n",
        ") cl\n",
        "  ON nt.cluster_id = cl.cluster_id\n",
        "WHERE \n",
        "  nt.cluster_id IS NOT NULL\n",
        "GROUP BY\n",
        "  nt.cluster_id, cl.cluster_name\n",
        "HAVING\n",
        "  `Avg CPU Utilization` IS NOT NULL\n",
        "ORDER BY\n",
        "  `Avg CPU Utilization` ASC\n",
        "LIMIT 10;"
      ]
    },
    {
      "name": "6d62f41d",
      "displayName": "10 Highest Memory",
      "queryLines": [
        "WITH latest_cluster_names AS (\n",
        "  SELECT\n",
        "    cluster_id,\n",
        "    cluster_name,\n",
        "    ROW_NUMBER() OVER (PARTITION BY cluster_id ORDER BY change_time DESC) AS rn\n",
        "  FROM system.compute.clusters\n",
        ")\n",
        "\n",
        "SELECT\n",
        "  nt.cluster_id,\n",
        "  cl.cluster_name,\n",
        "  AVG(cpu_user_percent + cpu_system_percent) AS `Avg CPU Utilization`,\n",
        "  AVG(mem_used_percent) AS `Avg Memory Utilization`,\n",
        "  CASE\n",
        "    WHEN AVG(cpu_user_percent + cpu_system_percent) < 50 OR AVG(mem_used_percent) < 50 THEN 'Underutilized'\n",
        "    WHEN AVG(cpu_user_percent + cpu_system_percent) > 80 OR AVG(mem_used_percent) > 80 THEN 'Overutilized'\n",
        "    ELSE 'Normal'\n",
        "  END AS utilization_status\n",
        "FROM\n",
        "  system.compute.node_timeline nt\n",
        "LEFT JOIN (\n",
        "  SELECT cluster_id, cluster_name\n",
        "  FROM latest_cluster_names\n",
        "  WHERE rn = 1\n",
        ") cl\n",
        "  ON nt.cluster_id = cl.cluster_id\n",
        "WHERE \n",
        "  nt.cluster_id IS NOT NULL\n",
        "GROUP BY\n",
        "  nt.cluster_id, cl.cluster_name\n",
        "ORDER BY\n",
        "  AVG(mem_used_percent) DESC\n",
        "LIMIT 10;\n"
      ]
    },
    {
      "name": "328b4d25",
      "displayName": "Top 20 Clusters With No Compute Policy",
      "queryLines": [
        "SELECT\n",
        "  c.cluster_id,\n",
        "  CONCAT(\n",
        "    '<a href=\"/compute/clusters/',\n",
        "    CAST(c.cluster_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(c.workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    c.cluster_name,\n",
        "    '</a>'\n",
        "  ) AS cluster_name,\n",
        "  c.owned_by,\n",
        "  ROUND(SUM(u.usage_quantity), 2) as list_cost,\n",
        "  c.workspace_id,\n",
        "  c.account_id\n",
        "FROM\n",
        "  system.billing.usage u\n",
        "  JOIN system.compute.clusters c\n",
        "  JOIN (SELECT u.record_id, c.cluster_id, max(c.change_time) change_time\n",
        "    FROM system.billing.usage u\n",
        "    JOIN system.compute.clusters c\n",
        "    WHERE\n",
        "      u.usage_metadata.cluster_id is not null\n",
        "      and u.usage_start_time >= '2023-01-01'\n",
        "      and u.usage_metadata.cluster_id = c.cluster_id\n",
        "      and date_trunc('HOUR', c.change_time) <= date_trunc('HOUR', u.usage_start_time)\n",
        "    GROUP BY all) config\n",
        "WHERE\n",
        "  c.policy_id IS NULL\n",
        "  and u.usage_metadata.cluster_id is not null\n",
        "  and u.usage_start_time >= '2023-01-01'\n",
        "  and u.usage_metadata.cluster_id = c.cluster_id\n",
        "  and u.record_id = config.record_id\n",
        "  and c.cluster_id = config.cluster_id\n",
        "  and c.change_time = config.change_time\n",
        "GROUP BY\n",
        "  c.cluster_id, c.cluster_name, c.owned_by, c.workspace_id, c.account_id\n",
        "ORDER BY\n",
        "  list_cost DESC\n",
        "LIMIT 20;"
      ]
    },
    {
      "name": "30fea210",
      "displayName": "Top Cluster With No Compute Policy Total",
      "queryLines": [
        "SELECT * FROM system.compute.clusters c WHERE c.policy_id IS NULL\n"
      ]
    },
    {
      "name": "481317e9",
      "displayName": "Top Cluster With Compute Policy Total 1",
      "queryLines": [
        "SELECT * FROM system.compute.clusters c WHERE c.policy_id IS NOT NULL"
      ]
    },
    {
      "name": "f8f80f40",
      "displayName": "Top 20 Clusters No Auto Terminate",
      "queryLines": [
        "SELECT\n",
        "  c.cluster_id,\n",
        "    CONCAT(\n",
        "    '<a href=\"/compute/clusters/',\n",
        "    CAST(c.cluster_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(c.workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    c.cluster_name,\n",
        "    '</a>'\n",
        "  ) AS cluster_name,\n",
        "  c.owned_by,\n",
        "  ROUND(SUM(u.usage_quantity),2) AS total_usage_quantity\n",
        "FROM\n",
        "  system.compute.clusters c\n",
        "LEFT JOIN\n",
        "  system.billing.usage u\n",
        "ON\n",
        "  c.cluster_id = u.usage_metadata.cluster_id\n",
        "WHERE\n",
        "  c.auto_termination_minutes IS NULL\n",
        "GROUP BY\n",
        "  c.cluster_id, c.cluster_name, c.owned_by, c.workspace_id\n",
        "ORDER BY\n",
        "  total_usage_quantity DESC\n",
        "LIMIT 20;"
      ]
    },
    {
      "name": "f86b4fea",
      "displayName": "Top Clusters No Auto Terminate Total",
      "queryLines": [
        "SELECT * FROM system.compute.clusters c WHERE c.auto_termination_minutes IS NULL"
      ]
    },
    {
      "name": "e2e14f35",
      "displayName": "Top Clusters Auto Terminate Total",
      "queryLines": [
        "SELECT * FROM system.compute.clusters c WHERE c.auto_termination_minutes IS NOT NULL"
      ]
    },
    {
      "name": "88aeb9f4",
      "displayName": "Top 20 Clusters Without Autoscaling",
      "queryLines": [
        "SELECT\n",
        "  c.cluster_id,\n",
        "    CONCAT(\n",
        "    '<a href=\"/compute/clusters/',\n",
        "    CAST(c.cluster_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(c.workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    c.cluster_name,\n",
        "    '</a>'\n",
        "  ) AS cluster_name,\n",
        "  c.owned_by,\n",
        "  ROUND(SUM(u.usage_quantity), 2) AS total_usage_quantity\n",
        "FROM\n",
        "  system.compute.clusters c\n",
        "LEFT JOIN\n",
        "  system.billing.usage u\n",
        "ON\n",
        "  c.cluster_id = u.usage_metadata.cluster_id\n",
        "WHERE\n",
        "  c.min_autoscale_workers IS NULL AND c.max_autoscale_workers IS NULL\n",
        "GROUP BY\n",
        "  c.cluster_id, c.cluster_name, c.owned_by, c.workspace_id\n",
        "ORDER BY\n",
        "  total_usage_quantity DESC\n",
        "LIMIT 20;"
      ]
    },
    {
      "name": "c8471ab1",
      "displayName": "Top Clusters Without Autoscaling",
      "queryLines": [
        "SELECT * FROM system.compute.clusters c WHERE c.min_autoscale_workers IS NULL AND c.max_autoscale_workers IS NULL"
      ]
    },
    {
      "name": "07ef34ff",
      "displayName": "Top Clusters With Autoscaling",
      "queryLines": [
        "SELECT * FROM system.compute.clusters c WHERE c.min_autoscale_workers IS NOT NULL OR c.max_autoscale_workers IS NOT NULL"
      ]
    },
    {
      "name": "46ed9664",
      "displayName": "Top 20 Clusters No Tag",
      "queryLines": [
        "SELECT\n",
        "  c.cluster_id,\n",
        "    CONCAT(\n",
        "    '<a href=\"/compute/clusters/',\n",
        "    CAST(c.cluster_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(c.workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    c.cluster_name,\n",
        "    '</a>'\n",
        "  ) AS cluster_name,\n",
        "  c.owned_by,\n",
        "  ROUND(SUM(u.usage_quantity), 2) AS total_usage_quantity\n",
        "FROM\n",
        "  system.compute.clusters c\n",
        "LEFT JOIN\n",
        "  system.billing.usage u\n",
        "ON\n",
        "  c.cluster_id = u.usage_metadata.cluster_id\n",
        "LEFT JOIN\n",
        "  system.compute.clusters t\n",
        "ON\n",
        "  c.cluster_id = t.cluster_id\n",
        "WHERE\n",
        "  t.tags IS NULL or size(t.tags) = 0\n",
        "GROUP BY\n",
        "  c.cluster_id, c.cluster_name, c.owned_by, c.workspace_id\n",
        "ORDER BY\n",
        "  total_usage_quantity DESC\n",
        "LIMIT 20;"
      ]
    },
    {
      "name": "9ba49670",
      "displayName": "Top Clusters No Tag",
      "queryLines": [
        "SELECT * FROM system.compute.clusters c WHERE c.tags IS NULL or size(c.tags) = 0"
      ]
    },
    {
      "name": "1e41ade9",
      "displayName": "Top Clusters With Tag",
      "queryLines": [
        "SELECT * FROM system.compute.clusters c WHERE c.tags IS NOT NULL AND size(c.tags) != 0"
      ]
    },
    {
      "name": "7880d910",
      "displayName": "Memory Swap Above X%",
      "queryLines": [
        "SELECT\n",
        "    CONCAT(\n",
        "    '<a href=\"https://e2-spog.staging.cloud.databricks.com/#job/',\n",
        "    CAST(c.cluster_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    c.cluster_id,\n",
        "    '</a>'\n",
        "  ) AS cluster_link,\n",
        "  AVG(mem_swap_percent) AS avg_memory_swap,\n",
        "  MAX(mem_swap_percent) AS peak_memory_swap,\n",
        "  COUNT(*) AS observation_count,\n",
        "  (ROUND(SUM (u.usage_quantity)), 2) AS list_cost,\n",
        "  c.owned_by,\n",
        "  c.workspace_id,\n",
        "  c.account_id\n",
        "FROM system.compute.node_timeline nt\n",
        "LEFT JOIN system.billing.usage u\n",
        "  ON usage_metadata.cluster_id = cluster_id\n",
        "  JOIN system.compute.clusters c\n",
        "  JOIN (SELECT u.record_id, c.cluster_id, max(c.change_time) change_time\n",
        "    FROM system.billing.usage u\n",
        "    JOIN system.compute.clusters c\n",
        "    WHERE\n",
        "      u.usage_metadata.cluster_id is not null\n",
        "      and u.usage_start_time >= '2025-07-01'\n",
        "      and u.usage_metadata.cluster_id = c.cluster_id\n",
        "      and date_trunc('HOUR', c.change_time) <= date_trunc('HOUR', u.usage_start_time)\n",
        "    GROUP BY all) config \n",
        "WHERE\n",
        "  u.usage_metadata.cluster_id is not null\n",
        "  and u.usage_start_time >= '2025-07-01'\n",
        "  and u.usage_metadata.cluster_id = c.cluster_id\n",
        "  and u.record_id = config.record_id\n",
        "  and c.cluster_id = config.cluster_id\n",
        "  and c.change_time = config.change_time\n",
        "GROUP BY cluster_link, c.owned_by, c.workspace_id, c.account_id\n",
        "HAVING AVG(mem_swap_percent) > 0.50 OR MAX(mem_swap_percent) > 0.90\n",
        "ORDER BY avg_memory_swap DESC\n",
        "LIMIT 10;"
      ]
    },
    {
      "name": "8bc2bb84",
      "displayName": "Top N Clusters Using Old VM Types",
      "queryLines": [
        "SELECT\n",
        "  CONCAT(\n",
        "    '<a href=\"/compute/clusters/',\n",
        "    CAST(c.cluster_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(c.workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    c.cluster_name,\n",
        "    '</a>'\n",
        "  ) AS cluster_name,\n",
        "  u.record_id,\n",
        "  c.cluster_id,\n",
        "  c.owned_by,\n",
        "  c.driver_node_type,\n",
        "  c.worker_node_type,\n",
        "  c.change_time,\n",
        "  u.usage_start_time,\n",
        "  u.usage_quantity\n",
        "FROM\n",
        "  system.billing.usage u\n",
        "  JOIN system.compute.clusters c\n",
        "  JOIN (SELECT u.record_id, c.cluster_id, max(c.change_time) change_time\n",
        "    FROM system.billing.usage u\n",
        "    JOIN system.compute.clusters c\n",
        "    WHERE\n",
        "      u.usage_metadata.cluster_id is not null\n",
        "      and u.usage_start_time >= date_add(now(), -3)\n",
        "      and u.usage_metadata.cluster_id = c.cluster_id\n",
        "      and date_trunc('HOUR', c.change_time) <= date_trunc('HOUR', u.usage_start_time)\n",
        "    GROUP BY all) config\n",
        "WHERE\n",
        "  u.usage_metadata.cluster_id is not null\n",
        "  and u.usage_start_time >= date_add(now(), -3)\n",
        "  and u.usage_metadata.cluster_id = c.cluster_id\n",
        "  and u.record_id = config.record_id\n",
        "  and c.cluster_id = config.cluster_id\n",
        "  and c.change_time = config.change_time\n",
        "  and c.driver_node_type REGEXP '^(i[23]|r[45]|m[45]|c[45])'\n",
        "  and c.worker_node_type REGEXP '^(i[23]|r[45]|m[45]|c[45])'\n",
        "ORDER BY cluster_id, usage_start_time desc\n",
        "LIMIT 20;"
      ]
    },
    {
      "name": "f8360ff1",
      "displayName": "CPU Wait Time Above Threshold",
      "queryLines": [
        "-- Step 1: Limit clusters to latest version only\n",
        "WITH latest_clusters AS (\n",
        "  SELECT *\n",
        "  FROM (\n",
        "    SELECT *,\n",
        "           ROW_NUMBER() OVER (PARTITION BY cluster_id ORDER BY change_time DESC) AS rn\n",
        "    FROM system.compute.clusters\n",
        "  )\n",
        "  WHERE rn = 1\n",
        "),\n",
        "\n",
        "-- Step 2: Filter node timeline data to the last 3 days\n",
        "filtered_node_timeline AS (\n",
        "  SELECT cluster_id, start_time\n",
        "  FROM system.compute.node_timeline\n",
        "  WHERE start_time >= CURRENT_DATE() - INTERVAL 3 DAY\n",
        "  GROUP BY cluster_id, start_time\n",
        "),\n",
        "\n",
        "-- Step 3: Filter usage data with node_type and date constraint\n",
        "filtered_usage AS (\n",
        "  SELECT\n",
        "    usage_metadata.cluster_id,\n",
        "    usage_metadata.node_type\n",
        "  FROM system.billing.usage\n",
        "  WHERE usage_date >= CURRENT_DATE() - INTERVAL 3 DAY\n",
        "    AND usage_metadata.node_type IS NOT NULL\n",
        "  GROUP BY usage_metadata.cluster_id, usage_metadata.node_type\n",
        "),\n",
        "\n",
        "-- Step 4: Join all sources and calculate adjusted throughput\n",
        "raw_ebs_data AS (\n",
        "  SELECT\n",
        "    u.node_type,\n",
        "    c.aws_attributes.ebs_volume_throughput,\n",
        "    c.aws_attributes.ebs_volume_iops,\n",
        "    c.aws_attributes.ebs_volume_size,\n",
        "    IFNULL(\n",
        "      c.aws_attributes.ebs_volume_throughput,\n",
        "      LEAST(250 * c.aws_attributes.ebs_volume_size / 100, 250)\n",
        "    ) AS adjusted_throughput\n",
        "  FROM filtered_usage u\n",
        "  INNER JOIN latest_clusters c\n",
        "    ON u.cluster_id = c.cluster_id\n",
        "  INNER JOIN filtered_node_timeline n\n",
        "    ON u.cluster_id = n.cluster_id\n",
        "),\n",
        "\n",
        "-- Step 5: Compute average metrics per node type\n",
        "ebs_metrics AS (\n",
        "  SELECT\n",
        "    node_type,\n",
        "    AVG(adjusted_throughput) AS avg_throughput,\n",
        "    AVG(ebs_volume_iops) AS avg_iops,\n",
        "    AVG(ebs_volume_size) AS avg_size\n",
        "  FROM raw_ebs_data\n",
        "  GROUP BY node_type\n",
        "),\n",
        "\n",
        "-- Step 6: Get core counts for node types\n",
        "node_core_counts AS (\n",
        "  SELECT\n",
        "    node_type,\n",
        "    core_count\n",
        "  FROM system.compute.node_types\n",
        "  WHERE core_count IS NOT NULL\n",
        ")\n",
        "\n",
        "-- Step 7: Final formatted output\n",
        "SELECT\n",
        "  e.node_type,\n",
        "  n.core_count,\n",
        "  ROUND(e.avg_size, 2) AS avg_size,\n",
        "  ROUND(e.avg_throughput, 2) AS avg_throughput,\n",
        "  ROUND(e.avg_iops, 2) AS avg_iops,\n",
        "  ROUND(e.avg_throughput / n.core_count, 2) AS throughput_per_vcpu,\n",
        "  ROUND(e.avg_iops / n.core_count, 2) AS iops_per_vcpu,\n",
        "  CASE\n",
        "    WHEN e.avg_throughput / n.core_count < 62.5 THEN 'LOW_THROUGHPUT_PER_VCPU'\n",
        "    ELSE 'OK'\n",
        "  END AS throughput_status,\n",
        "  CASE\n",
        "    WHEN e.avg_iops / n.core_count < 50 THEN 'LOW_IOPS_PER_VCPU'\n",
        "    ELSE 'OK'\n",
        "  END AS iops_status\n",
        "FROM ebs_metrics e\n",
        "JOIN node_core_counts n\n",
        "  ON e.node_type = n.node_type\n",
        "ORDER BY throughput_per_vcpu ASC\n",
        "LIMIT 10;\n"
      ]
    },
    {
      "name": "85f0530d",
      "displayName": "30_60 Day List Spend",
      "queryLines": [
        "with jobs_usage_with_list_cost as (\n",
        "  SELECT\n",
        "    t1.*,\n",
        "    t1.usage_quantity * list_prices.pricing.default as list_cost\n",
        "  FROM system.billing.usage t1 \n",
        "  INNER JOIN system.billing.list_prices list_prices on\n",
        "      t1.cloud = list_prices.cloud and\n",
        "      t1.sku_name = list_prices.sku_name and\n",
        "      t1.usage_start_time >= list_prices.price_start_time and\n",
        "      (t1.usage_end_time <= list_prices.price_end_time or list_prices.price_end_time is null)\n",
        "  WHERE\n",
        "    t1.sku_name LIKE '%JOBS%'\n",
        ")\n",
        "SELECT\n",
        "    *\n",
        "    ,try_divide( (last30DaySpend - last30to60DaySpend) , last30to60DaySpend) * 100 AS Last30DayGrowth\n",
        "FROM\n",
        "  (\n",
        "    SELECT\n",
        "      SUM(list_cost) AS spend\n",
        "      ,sku_name\n",
        "      ,SUM(CASE WHEN usage_end_time BETWEEN date_add(current_date(), -30) AND current_date() THEN list_cost ELSE 0 END) AS Last30DaySpend\n",
        "      ,SUM(CASE WHEN usage_end_time BETWEEN date_add(current_date(), -60) AND date_add(current_date(), -31) THEN list_cost ELSE 0 END) AS Last30to60DaySpend\n",
        "    FROM jobs_usage_with_list_cost\n",
        "    GROUP BY ALL\n",
        "  )"
      ]
    },
    {
      "name": "d8fea384",
      "displayName": "Top 20 Most Expensive AP Clusters",
      "queryLines": [
        "WITH config AS (\n",
        "  SELECT\n",
        "    u.record_id,\n",
        "    c.cluster_id,\n",
        "    MAX(c.change_time) AS change_time\n",
        "  FROM system.billing.usage u\n",
        "  JOIN system.compute.clusters c\n",
        "    ON u.usage_metadata.cluster_id = c.cluster_id\n",
        "  WHERE\n",
        "    u.usage_metadata.cluster_id IS NOT NULL\n",
        "    AND u.usage_start_time >= CURRENT_DATE - INTERVAL 30 DAY\n",
        "    AND DATE_TRUNC('HOUR', c.change_time) <= DATE_TRUNC('HOUR', u.usage_start_time)\n",
        "  GROUP BY u.record_id, c.cluster_id\n",
        "),\n",
        "\n",
        "joined_usage AS (\n",
        "  SELECT\n",
        "    u.record_id,\n",
        "    u.usage_metadata.cluster_id,\n",
        "    c.owned_by,\n",
        "    c.cluster_name,\n",
        "    u.usage_start_time,\n",
        "    u.usage_end_time,\n",
        "    u.usage_quantity,\n",
        "    lp.pricing.default AS dbu_price\n",
        "  FROM system.billing.usage u\n",
        "  JOIN config\n",
        "    ON u.record_id = config.record_id\n",
        "   AND u.usage_metadata.cluster_id = config.cluster_id\n",
        "  JOIN system.compute.clusters c\n",
        "    ON c.cluster_id = config.cluster_id\n",
        "   AND c.change_time = config.change_time\n",
        "  JOIN system.billing.list_prices lp\n",
        "    ON u.sku_name = lp.sku_name\n",
        "   AND u.cloud = lp.cloud\n",
        "   AND u.usage_start_time >= lp.price_start_time\n",
        "   AND (u.usage_end_time <= lp.price_end_time OR lp.price_end_time IS NULL)\n",
        "  WHERE\n",
        "    u.usage_start_time >= CURRENT_DATE - INTERVAL 30 DAY\n",
        "    AND u.sku_name LIKE 'ENTERPRISE_ALL_PURPOSE_COMPUTE'\n",
        "\n",
        ")\n",
        "\n",
        "SELECT\n",
        "  cluster_id,\n",
        "  cluster_name,\n",
        "  owned_by,\n",
        "  COUNT(DISTINCT DATE(usage_start_time)) AS active_days,\n",
        "  SUM(usage_quantity * dbu_price) AS total_list_cost_usd,\n",
        "  MAX(usage_end_time) AS last_seen\n",
        "FROM joined_usage\n",
        "GROUP BY\n",
        "  cluster_id,\n",
        "  cluster_name,\n",
        "  owned_by\n",
        "ORDER BY total_list_cost_usd DESC\n",
        "LIMIT 20;\n"
      ]
    },
    {
      "name": "a5cf41d7",
      "displayName": "Top 20 Job Runs on AP Clusters",
      "queryLines": [
        "with clusters AS (\n",
        "  SELECT\n",
        "    *,\n",
        "    ROW_NUMBER() OVER(PARTITION BY workspace_id, cluster_id ORDER BY change_time DESC) as rn\n",
        "  FROM system.compute.clusters\n",
        "  WHERE cluster_source=\"UI\"\n",
        "  QUALIFY rn=1\n",
        "),\n",
        "job_tasks_exploded AS (\n",
        "  SELECT\n",
        "    workspace_id,\n",
        "    job_id,\n",
        "    EXPLODE(compute_ids) as cluster_id\n",
        "  FROM system.lakeflow.job_task_run_timeline\n",
        "  WHERE period_start_time >= CURRENT_DATE() - INTERVAL 30 DAY \n",
        "),\n",
        "all_purpose_cluster_jobs AS (\n",
        "  SELECT\n",
        "    t1.*,\n",
        "    t2.cluster_name,\n",
        "    t2.owned_by,\n",
        "    t2.dbr_version\n",
        "  FROM job_tasks_exploded t1 \n",
        "    INNER JOIN clusters t2 USING (workspace_id, cluster_id)\n",
        "),\n",
        "most_recent_jobs as (\n",
        "  SELECT \n",
        "    *, \n",
        "    ROW_NUMBER() OVER(PARTITION BY workspace_id, job_id ORDER BY change_time DESC) as rn\n",
        "  FROM\n",
        "    system.lakeflow.jobs QUALIFY rn=1\n",
        ")\n",
        "SELECT \n",
        "  t1.workspace_id,\n",
        "  t1.job_id,\n",
        "  first(t2.name, TRUE) as name,\n",
        "  array_size(collect_list(t1.cluster_id)) as task_runs,\n",
        "  collect_set(\n",
        "    named_struct(\n",
        "      'cluster_id', t1.cluster_id,\n",
        "      'cluster_name', t1.cluster_name\n",
        "    )\n",
        "  ) as clusters_list\n",
        "FROM all_purpose_cluster_jobs t1 \n",
        "  LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n",
        "GROUP BY t1.workspace_id, t1.job_id \n",
        "ORDER BY task_runs DESC\n",
        "LIMIT 20;"
      ]
    },
    {
      "name": "95221dee",
      "displayName": "Outlier Job Runs Last 30 Days",
      "queryLines": [
        "-- SPENDING BROKEN DOWN BY JOB\n",
        "with stats_per_job_run as (\n",
        "  SELECT\n",
        "    t1.workspace_id,\n",
        "      CONCAT(\n",
        "    '<a href=\"/jobs/',\n",
        "    CAST(t1.usage_metadata.job_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(t1.workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    t1.usage_metadata.job_name,\n",
        "    '</a>'\n",
        "  ) AS job_name,\n",
        "    t1.usage_metadata.job_run_id as run_id,\n",
        "    SUM(t1.usage_quantity * list_prices.pricing.default) as list_cost,\n",
        "    first(identity_metadata.run_as, true) as run_as,\n",
        "    first(t1.custom_tags, true) as custom_tags,\n",
        "    MAX(t1.usage_end_time) as last_seen,\n",
        "    MIN(t1.usage_start_time) as first_seen\n",
        "  FROM system.billing.usage t1 \n",
        "  INNER JOIN system.billing.list_prices list_prices on\n",
        "      t1.cloud = list_prices.cloud and\n",
        "      t1.sku_name = list_prices.sku_name and\n",
        "      t1.usage_start_time >= list_prices.price_start_time and\n",
        "      (t1.usage_end_time <= list_prices.price_end_time or list_prices.price_end_time is null)\n",
        "  WHERE\n",
        "      t1.sku_name LIKE '%JOBS%'\n",
        "      AND t1.usage_metadata.job_id IS NOT NULL\n",
        "      AND t1.usage_metadata.job_run_id IS NOT NULL\n",
        "      AND t1.usage_start_time >= CURRENT_DATE() - INTERVAL 30 DAY \n",
        "  GROUP BY 1,2,3\n",
        "), \n",
        "stats_per_job AS (\n",
        "  SELECT\n",
        "    workspace_id,\n",
        "    job_name,\n",
        "    COUNT(run_id) AS runs,\n",
        "    SUM(list_cost) AS total_list_cost,\n",
        "    AVG(list_cost) AS avg_list_cost,\n",
        "    MAX(list_cost) AS max_list_cost,\n",
        "    percentile(list_cost, 0.9) AS p90\n",
        "  FROM\n",
        "    stats_per_job_run\n",
        "  WHERE\n",
        "    first_seen > CURRENT_TIMESTAMP() - INTERVAL 30 DAYS\n",
        "  GROUP BY ALL\n",
        "  ORDER BY\n",
        "    total_list_cost DESC\n",
        ")\n",
        "SELECT\n",
        "  *,\n",
        "  (max_list_cost - p90) AS list_cost_deviation_from_p90\n",
        "FROM\n",
        "  stats_per_job\n",
        "ORDER BY\n",
        "  list_cost_deviation_from_p90 DESC\n",
        "LIMIT 20"
      ]
    },
    {
      "name": "d13ce183",
      "displayName": "AP Clusters by Jobs",
      "queryLines": [
        "with clusters AS (\n",
        "  SELECT\n",
        "    *,\n",
        "    ROW_NUMBER() OVER(PARTITION BY workspace_id, cluster_id ORDER BY change_time DESC) as rn\n",
        "  FROM system.compute.clusters\n",
        "  WHERE cluster_source=\"UI\"\n",
        "  QUALIFY rn=1\n",
        "),\n",
        "job_tasks_exploded AS (\n",
        "  SELECT\n",
        "    workspace_id,\n",
        "    job_id,\n",
        "    EXPLODE(compute_ids) as cluster_id\n",
        "  FROM system.lakeflow.job_task_run_timeline\n",
        "  WHERE period_start_time >= CURRENT_DATE() - INTERVAL 30 DAY \n",
        "),\n",
        "all_purpose_cluster_jobs AS (\n",
        "  SELECT\n",
        "    t1.*,\n",
        "    t2.cluster_name,\n",
        "    t2.owned_by,\n",
        "    t2.dbr_version\n",
        "  FROM job_tasks_exploded t1 \n",
        "    INNER JOIN clusters t2 USING (workspace_id, cluster_id)\n",
        "),\n",
        "most_recent_jobs as (\n",
        "  SELECT \n",
        "    *, \n",
        "    ROW_NUMBER() OVER(PARTITION BY workspace_id, job_id ORDER BY change_time DESC) as rn\n",
        "  FROM\n",
        "    system.lakeflow.jobs QUALIFY rn=1\n",
        "-- )\n",
        "),\n",
        "ap_clusters_by_jobs as (\n",
        "  SELECT \n",
        "    t1.workspace_id,\n",
        "    t1.cluster_id,\n",
        "    first(t1.cluster_name, TRUE) as cluster_name,\n",
        "    array_size(collect_list(t1.cluster_id)) as task_runs,\n",
        "    collect_set(\n",
        "      named_struct(\n",
        "        'job_id', t1.job_id,\n",
        "        'job_name', t2.name\n",
        "      )\n",
        "    ) as jobs_list\n",
        "  FROM all_purpose_cluster_jobs t1 \n",
        "    LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n",
        "  GROUP BY t1.workspace_id, t1.cluster_id \n",
        "  ORDER BY task_runs DESC\n",
        "  LIMIT 100\n",
        ")\n",
        "SELECT\n",
        "  t1.workspace_id,\n",
        "  t1.usage_metadata.cluster_id,\n",
        "  first(t2.cluster_name, TRUE) as cluster_name,\n",
        "  first(t2.task_runs) as task_runs,\n",
        "  SUM(t1.usage_quantity * list_prices.pricing.default) as list_cost,\n",
        "  first(t2.jobs_list) as jobs_list,\n",
        "  MAX(t1.usage_end_time) as last_seen_date\n",
        "FROM system.billing.usage t1 \n",
        "INNER JOIN system.billing.list_prices list_prices on\n",
        "  t1.cloud = list_prices.cloud and\n",
        "  t1.sku_name = list_prices.sku_name and\n",
        "  t1.usage_start_time >= list_prices.price_start_time and\n",
        "  (t1.usage_end_time <= list_prices.price_end_time or list_prices.price_end_time is null)\n",
        "INNER JOIN ap_clusters_by_jobs t2 ON t1.workspace_id=t2.workspace_id AND t1.usage_metadata.cluster_id=t2.cluster_id\n",
        "WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAY \n",
        "GROUP BY ALL\n",
        "ORDER BY list_cost DESC"
      ]
    },
    {
      "name": "97da2baf",
      "displayName": "Low CPU Utilization Jobs",
      "queryLines": [
        "with list_cost_per_job_cluster as (\n",
        "  SELECT\n",
        "    t1.workspace_id,\n",
        "    t1.usage_metadata.job_id,\n",
        "    t1.usage_metadata.cluster_id,\n",
        "    COUNT(DISTINCT t1.usage_metadata.job_run_id) as runs,\n",
        "    SUM(t1.usage_quantity * list_prices.pricing.default) as list_cost,\n",
        "    first(identity_metadata.run_as, true) as run_as,\n",
        "    first(t1.custom_tags, true) as custom_tags,\n",
        "    MAX(t1.usage_end_time) as last_seen_date\n",
        "  FROM system.billing.usage t1 \n",
        "  INNER JOIN system.billing.list_prices list_prices on\n",
        "    t1.cloud = list_prices.cloud and\n",
        "    t1.sku_name = list_prices.sku_name and\n",
        "    t1.usage_start_time >= list_prices.price_start_time and\n",
        "    (t1.usage_end_time <= list_prices.price_end_time or list_prices.price_end_time is null)\n",
        "  WHERE\n",
        "    t1.sku_name LIKE '%JOBS%'\n",
        "\tand t1.sku_name not ilike '%jobs_serverless%'\n",
        "    AND t1.usage_metadata.job_id IS NOT NULL\n",
        "    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAY \n",
        "  GROUP BY ALL\n",
        "),\n",
        "most_recent_jobs as (\n",
        "  SELECT \n",
        "    *, \n",
        "    ROW_NUMBER() OVER(PARTITION BY workspace_id, job_id ORDER BY change_time DESC) as rn\n",
        "  FROM\n",
        "    system.lakeflow.jobs QUALIFY rn=1\n",
        "),\n",
        "\n",
        "jobsrollingmonth as (\n",
        "SELECT \n",
        "    t2.name,\n",
        "    t1.job_id,\n",
        "    t1.workspace_id,\n",
        "    t1.cluster_id,\n",
        "    t1.runs,\n",
        "    t1.run_as,\n",
        "    SUM(list_cost) as list_cost,\n",
        "    t1.last_seen_date\n",
        "FROM list_cost_per_job_cluster t1 \n",
        "  LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n",
        "GROUP BY ALL\n",
        "ORDER BY list_cost DESC ),\n",
        "\n",
        "clusterutil as (SELECT * from \n",
        "\tsystem.compute.node_timeline\n",
        "WHERE\n",
        "\tstart_time >= CURRENT_DATE() - INTERVAL 30 DAY \n",
        "),\n",
        "\n",
        "jobswithutil as (\n",
        "select jobsrollingmonth.workspace_id, jobsrollingmonth.name,     \n",
        "  CONCAT(\n",
        "    '<a href=\"/compute/clusters/',\n",
        "    CAST(clusterutil.cluster_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(clusterutil.workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    clusterutil.cluster_id,\n",
        "    '</a>'\n",
        "  ) AS cluster_link,\n",
        "avg(cpu_user_percent + cpu_system_percent) as `Avg CPU Utilization`, \n",
        "max(cpu_user_percent + cpu_system_percent) as `Peak CPU Utilization`, \n",
        "\tavg(cpu_wait_percent) as `Avg CPU Disk Wait`,\n",
        "\tmax(cpu_wait_percent) as `Max CPU Disk Wait`,\n",
        "\tavg(mem_used_percent) as `Avg Memory Utilization`, \n",
        "\tmax(mem_used_percent) as `Max Memory Utilization`\n",
        "from clusterutil \n",
        "join jobsrollingmonth\n",
        "on clusterutil.cluster_id = jobsrollingmonth.cluster_id\n",
        "group by 1, 2, clusterutil.cluster_id, clusterutil.workspace_id)\n",
        "\n",
        "select *\n",
        "from jobswithutil\n",
        "order by `Avg CPU Utilization` asc\n",
        "limit 10"
      ]
    },
    {
      "name": "a55f1589",
      "displayName": "High Memory Utilization Jobs",
      "queryLines": [
        "with list_cost_per_job_cluster as (\n",
        "  SELECT\n",
        "    t1.workspace_id,\n",
        "    t1.usage_metadata.job_id,\n",
        "    t1.usage_metadata.cluster_id,\n",
        "    COUNT(DISTINCT t1.usage_metadata.job_run_id) as runs,\n",
        "    SUM(t1.usage_quantity * list_prices.pricing.default) as list_cost,\n",
        "    first(identity_metadata.run_as, true) as run_as,\n",
        "    first(t1.custom_tags, true) as custom_tags,\n",
        "    MAX(t1.usage_end_time) as last_seen_date\n",
        "  FROM system.billing.usage t1 \n",
        "  INNER JOIN system.billing.list_prices list_prices on\n",
        "    t1.cloud = list_prices.cloud and\n",
        "    t1.sku_name = list_prices.sku_name and\n",
        "    t1.usage_start_time >= list_prices.price_start_time and\n",
        "    (t1.usage_end_time <= list_prices.price_end_time or list_prices.price_end_time is null)\n",
        "  WHERE\n",
        "    t1.sku_name LIKE '%JOBS%'\n",
        "\tand t1.sku_name not ilike '%jobs_serverless%'\n",
        "    AND t1.usage_metadata.job_id IS NOT NULL\n",
        "    AND t1.usage_date >= CURRENT_DATE() - INTERVAL 30 DAY \n",
        "  GROUP BY ALL\n",
        "),\n",
        "most_recent_jobs as (\n",
        "  SELECT \n",
        "    *, \n",
        "    ROW_NUMBER() OVER(PARTITION BY workspace_id, job_id ORDER BY change_time DESC) as rn\n",
        "  FROM\n",
        "    system.lakeflow.jobs QUALIFY rn=1\n",
        "),\n",
        "\n",
        "jobsrollingmonth as (\n",
        "SELECT \n",
        "    t2.name,\n",
        "    t1.job_id,\n",
        "    t1.workspace_id,\n",
        "    t1.cluster_id,\n",
        "    t1.runs,\n",
        "    t1.run_as,\n",
        "    SUM(list_cost) as list_cost,\n",
        "    t1.last_seen_date\n",
        "FROM list_cost_per_job_cluster t1 \n",
        "  LEFT JOIN most_recent_jobs t2 USING (workspace_id, job_id)\n",
        "GROUP BY ALL\n",
        "ORDER BY list_cost DESC ),\n",
        "\n",
        "clusterutil as (SELECT * from \n",
        "\tsystem.compute.node_timeline\n",
        "WHERE\n",
        "\tstart_time >= CURRENT_DATE() - INTERVAL 30 DAY \n",
        "),\n",
        "\n",
        "jobswithutil as (\n",
        "select jobsrollingmonth.workspace_id, jobsrollingmonth.name,   \n",
        "  CONCAT(\n",
        "    '<a href=\"/compute/clusters/',\n",
        "    CAST(clusterutil.cluster_id AS STRING),\n",
        "    '?o=',\n",
        "    CAST(clusterutil.workspace_id AS STRING),\n",
        "    '\" target=\"_blank\">',\n",
        "    clusterutil.cluster_id,\n",
        "    '</a>'\n",
        "  ) AS cluster_link,\n",
        "avg(cpu_user_percent + cpu_system_percent) as `Avg CPU Utilization`, \n",
        "max(cpu_user_percent + cpu_system_percent) as `Peak CPU Utilization`, \n",
        "\tavg(cpu_wait_percent) as `Avg CPU Disk Wait`,\n",
        "\tmax(cpu_wait_percent) as `Max CPU Disk Wait`,\n",
        "\tavg(mem_used_percent) as `Avg Memory Utilization`, \n",
        "\tmax(mem_used_percent) as `Max Memory Utilization`\n",
        "from clusterutil \n",
        "join jobsrollingmonth\n",
        "on clusterutil.cluster_id = jobsrollingmonth.cluster_id\n",
        "group by 1, 2, clusterutil.cluster_id, clusterutil.workspace_id)\n",
        "\n",
        "select *\n",
        "from jobswithutil\n",
        "order by `Avg Memory Utilization` desc\n",
        "limit 10"
      ]
    },
    {
      "name": "bdae0f82",
      "displayName": "Jobs to Cluster Mapping",
      "queryLines": [
        "-- SELECT\n",
        "--   ejc.workspace_id,\n",
        "--   ejc.job_id,\n",
        "--   lj.name AS job_name,\n",
        "--   ejc.run_id,\n",
        "--   ejc.cluster_id,\n",
        "--   ejc.period_start_time,\n",
        "--   ejc.period_end_time\n",
        "-- FROM exploded_job_clusters ejc\n",
        "-- LEFT JOIN latest_clusters lc\n",
        "--   ON ejc.workspace_id = lc.workspace_id AND ejc.cluster_id = lc.cluster_id AND lc.rn = 1\n",
        "-- LEFT JOIN latest_jobs lj\n",
        "--   ON ejc.workspace_id = lj.workspace_id AND ejc.job_id = lj.job_id AND lj.rn = 1\n",
        "-- ORDER BY ejc.workspace_id, ejc.job_id, ejc.period_start_time DESC\n",
        "-- LIMIT 50;\n"
      ]
    }
  ],
  "pages": [
    {
      "name": "89173e8d",
      "displayName": "Jobs",
      "layout": [
        {
          "widget": {
            "name": "a6d61800",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "4acfabb6",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "sum(failed_runs)",
                      "expression": "SUM(`failed_runs`)"
                    },
                    {
                      "name": "sum(successful_runs)",
                      "expression": "SUM(`successful_runs`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "job_id",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "y-reversed"
                    }
                  },
                  "displayName": "job_id"
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "sum(failed_runs)",
                      "displayName": "# of Failed Runs"
                    },
                    {
                      "fieldName": "sum(successful_runs)",
                      "displayName": "# of Successful Runs"
                    }
                  ],
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 2
                    }
                  }
                },
                "color": {
                  "legend": {
                    "hideTitle": false,
                    "hide": false
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Recurring Failed Jobs",
                "description": "Identify jobs which have failed repeadedly.\nDefault is more than10 times in the last week with at least 50% failing"
              },
              "mark": {
                "layout": "stack"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 22,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "06247fdf",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "4c82fb4e",
                  "fields": [
                    {
                      "name": "result_state",
                      "expression": "`result_state`"
                    },
                    {
                      "name": "daily(period_end_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `period_end_time`)"
                    },
                    {
                      "name": "countdistinct(run_id)",
                      "expression": "COUNT(DISTINCT `run_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(period_end_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "period_end_time"
                },
                "y": {
                  "fieldName": "countdistinct(run_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of Unique run_id"
                },
                "color": {
                  "fieldName": "result_state",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "ERROR",
                        "color": {
                          "themeColorType": "visualizationColors",
                          "position": 6
                        }
                      },
                      {
                        "value": "SUCCEEDED",
                        "color": {
                          "themeColorType": "visualizationColors",
                          "position": 3
                        }
                      },
                      {
                        "value": "FAILED",
                        "color": {
                          "themeColorType": "visualizationColors",
                          "position": 4
                        }
                      },
                      {
                        "value": "SKIPPED",
                        "color": {
                          "themeColorType": "visualizationColors",
                          "position": 8
                        }
                      },
                      {
                        "value": "TIMED_OUT",
                        "color": {
                          "themeColorType": "visualizationColors",
                          "position": 9
                        }
                      }
                    ]
                  },
                  "displayName": "result_state"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Job Success Rate Over The Last Year",
                "description": ""
              },
              "mark": {
                "layout": "percent-stack"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "43a21cbd",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "7700ca5e",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "run_as_email",
                      "expression": "`run_as_email`"
                    },
                    {
                      "name": "list_cost",
                      "expression": "`list_cost`"
                    },
                    {
                      "name": "last_seen_date",
                      "expression": "`last_seen_date`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "job_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "job_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "workspace_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "workspace_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_id"
                  },
                  {
                    "fieldName": "runs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100003,
                    "title": "runs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "runs"
                  },
                  {
                    "fieldName": "run_as_email",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "run_as_email",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "run_as_email"
                  },
                  {
                    "fieldName": "list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost"
                  },
                  {
                    "fieldName": "last_seen_date",
                    "dateTimeFormat": "DD/MM/YYYY HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100006,
                    "title": "last_seen_date",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "last_seen_date"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": true,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Most Expensive Jobs Last 30 Days"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 8,
            "width": 5,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "6f74493b",
            "multilineTextboxSpec": {
              "lines": [
                "# Jobs Insights\n",
                "\n",
                "---\n",
                "\n",
                "## Sections\n",
                "\n",
                "1. Most Expensive Jobs Overview\n",
                "2. Job Success Rate Overview\n",
                "3. Recurring Failed Jobs\n",
                "\n",
                "## Filters\n",
                "\n",
                "- Filters will match to all visualizations on this page. \n",
                "- The date filter will match to the end time of a job.\n",
                "- The \"Most Expensive Jobs Last 30 Days\" does not contain all jobs, filtering Job ID may not return results if it is not one of the most expensive."
              ]
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "9f383ea2",
            "queries": [
              {
                "name": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05c43939e107eb0908fdf55fe09bc_last_seen_date",
                "query": {
                  "datasetName": "7700ca5e",
                  "fields": [
                    {
                      "name": "last_seen_date",
                      "expression": "`last_seen_date`"
                    },
                    {
                      "name": "last_seen_date_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05b8a3bfa1284847b2b05f4bec9bd_last_failure_time",
                "query": {
                  "datasetName": "4acfabb6",
                  "fields": [
                    {
                      "name": "last_failure_time",
                      "expression": "`last_failure_time`"
                    },
                    {
                      "name": "last_failure_time_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05c427864189fbea1cf878bb77014_period_end_time",
                "query": {
                  "datasetName": "4c82fb4e",
                  "fields": [
                    {
                      "name": "period_end_time",
                      "expression": "`period_end_time`"
                    },
                    {
                      "name": "period_end_time_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "last_seen_date",
                    "displayName": "last_seen_date",
                    "queryName": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05c43939e107eb0908fdf55fe09bc_last_seen_date"
                  },
                  {
                    "fieldName": "last_failure_time",
                    "displayName": "last_failure_time",
                    "queryName": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05b8a3bfa1284847b2b05f4bec9bd_last_failure_time"
                  },
                  {
                    "fieldName": "period_end_time",
                    "displayName": "period_end_time",
                    "queryName": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05c427864189fbea1cf878bb77014_period_end_time"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Date Range\n"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "1803382b",
            "queries": [
              {
                "name": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05c43939e107eb0908fdf55fe09bc_runs",
                "query": {
                  "datasetName": "7700ca5e",
                  "fields": [
                    {
                      "name": "min(runs)",
                      "expression": "MIN(`runs`)"
                    },
                    {
                      "name": "max(runs)",
                      "expression": "MAX(`runs`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "range-slider",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "runs",
                    "displayName": "runs",
                    "queryName": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05c43939e107eb0908fdf55fe09bc_runs"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "INTEGER",
                    "min": {
                      "value": "1"
                    },
                    "max": {
                      "value": "1000"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "# Runs"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 6,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cc65a3b2",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "4acfabb6",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "account_id",
                      "expression": "`account_id`"
                    },
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    },
                    {
                      "name": "failed_runs",
                      "expression": "`failed_runs`"
                    },
                    {
                      "name": "successful_runs",
                      "expression": "`successful_runs`"
                    },
                    {
                      "name": "failure_rate_percent",
                      "expression": "`failure_rate_percent`"
                    },
                    {
                      "name": "last_failure_time",
                      "expression": "`last_failure_time`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "job_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "job_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "job_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_id"
                  },
                  {
                    "fieldName": "account_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "account_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "account_id"
                  },
                  {
                    "fieldName": "workspace_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "workspace_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_id"
                  },
                  {
                    "fieldName": "total_runs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 4,
                    "title": "total_runs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "total_runs"
                  },
                  {
                    "fieldName": "failed_runs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 5,
                    "title": "failed_runs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "failed_runs"
                  },
                  {
                    "fieldName": "successful_runs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 6,
                    "title": "successful_runs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "successful_runs"
                  },
                  {
                    "fieldName": "failure_rate_percent",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 7,
                    "title": "failure_rate_percent",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "failure_rate_percent"
                  },
                  {
                    "fieldName": "last_failure_time",
                    "dateTimeFormat": "DD/MM/YYYY HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 8,
                    "title": "last_failure_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "last_failure_time"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Recurring Failed Jobs ",
                "showDescription": true,
                "description": "Identify jobs which have failed more than 10 times in the last week - at least 50% failing"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 28,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "5ad754e2",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "85f0530d",
                  "fields": [
                    {
                      "name": "Last30DaySpend",
                      "expression": "`Last30DaySpend`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "Last30DaySpend",
                  "displayName": "Last30DaySpend"
                }
              },
              "frame": {
                "showDescription": false,
                "showTitle": true,
                "title": "30 Day Job List Spend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "1756818d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "85f0530d",
                  "fields": [
                    {
                      "name": "Last30to60DaySpend",
                      "expression": "`Last30to60DaySpend`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "Last30to60DaySpend",
                  "displayName": "Last30to60DaySpend"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-60 Day Job List Spend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "d4405a72",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "85f0530d",
                  "fields": [
                    {
                      "name": "Last30DayGrowth",
                      "expression": "`Last30DayGrowth`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "Last30DayGrowth",
                  "displayName": "Last30DayGrowth"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30 Day Cost Growth %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "7ae53df0",
            "queries": [
              {
                "name": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05c43939e107eb0908fdf55fe09bc_job_id",
                "query": {
                  "datasetName": "7700ca5e",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05b8a3bfa1284847b2b05f4bec9bd_job_id",
                "query": {
                  "datasetName": "4acfabb6",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05c427864189fbea1cf878bb77014_job_id",
                "query": {
                  "datasetName": "4c82fb4e",
                  "fields": [
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    },
                    {
                      "name": "job_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05c43939e107eb0908fdf55fe09bc_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05b8a3bfa1284847b2b05f4bec9bd_job_id"
                  },
                  {
                    "fieldName": "job_id",
                    "displayName": "job_id",
                    "queryName": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05c427864189fbea1cf878bb77014_job_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Job ID"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 6,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "f749c044",
            "queries": [
              {
                "name": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05b8a3bfa1284847b2b05f4bec9bd_failed_runs",
                "query": {
                  "datasetName": "4acfabb6",
                  "fields": [
                    {
                      "name": "min(failed_runs)",
                      "expression": "MIN(`failed_runs`)"
                    },
                    {
                      "name": "max(failed_runs)",
                      "expression": "MAX(`failed_runs`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "range-slider",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "failed_runs",
                    "displayName": "failed_runs",
                    "queryName": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05b8a3bfa1284847b2b05f4bec9bd_failed_runs"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Number of failed runs"
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "INTEGER",
                    "min": {
                      "value": "0"
                    },
                    "max": {
                      "value": ""
                    }
                  }
                }
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "c2d85b64",
            "queries": [
              {
                "name": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05b8a3bfa1284847b2b05f4bec9bd_failure_rate_percent",
                "query": {
                  "datasetName": "4acfabb6",
                  "fields": [
                    {
                      "name": "min(failure_rate_percent)",
                      "expression": "MIN(`failure_rate_percent`)"
                    },
                    {
                      "name": "max(failure_rate_percent)",
                      "expression": "MAX(`failure_rate_percent`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "range-slider",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "failure_rate_percent",
                    "displayName": "failure_rate_percent",
                    "queryName": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05b8a3bfa1284847b2b05f4bec9bd_failure_rate_percent"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Failed run %"
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DECIMAL",
                    "min": {
                      "value": "0"
                    },
                    "max": {
                      "value": "100"
                    }
                  }
                }
              }
            }
          },
          "position": {
            "x": 3,
            "y": 14,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "ff10f57f",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "95221dee",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "total_list_cost",
                      "expression": "`total_list_cost`"
                    },
                    {
                      "name": "avg_list_cost",
                      "expression": "`avg_list_cost`"
                    },
                    {
                      "name": "max_list_cost",
                      "expression": "`max_list_cost`"
                    },
                    {
                      "name": "p90",
                      "expression": "`p90`"
                    },
                    {
                      "name": "list_cost_deviation_from_p90",
                      "expression": "`list_cost_deviation_from_p90`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "job_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "workspace_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "workspace_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_id"
                  },
                  {
                    "fieldName": "runs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 2,
                    "title": "runs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "runs"
                  },
                  {
                    "fieldName": "total_list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3,
                    "title": "total_list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "total_list_cost"
                  },
                  {
                    "fieldName": "avg_list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 4,
                    "title": "avg_list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "avg_list_cost"
                  },
                  {
                    "fieldName": "max_list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 5,
                    "title": "max_list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "max_list_cost"
                  },
                  {
                    "fieldName": "p90",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 6,
                    "title": "p90",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "p90"
                  },
                  {
                    "fieldName": "list_cost_deviation_from_p90",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 7,
                    "title": "list_cost_deviation_from_p90",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost_deviation_from_p90"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": true,
              "frame": {
                "showTitle": true,
                "title": "Outlier Job Runs Last 30 Days",
                "showDescription": true,
                "description": "Jobs runs which deviated most from the p90 cost"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 34,
            "width": 6,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "cbe89f0b",
      "displayName": "Cluster Monitoring",
      "layout": [
        {
          "widget": {
            "name": "6baef963",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "d82de996",
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    },
                    {
                      "name": "dbr_version",
                      "expression": "`dbr_version`"
                    },
                    {
                      "name": "list_cost",
                      "expression": "`list_cost`"
                    },
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "account_id",
                      "expression": "`account_id`"
                    },
                    {
                      "name": "owned_by",
                      "expression": "`owned_by`"
                    },
                    {
                      "name": "create_time",
                      "expression": "`create_time`"
                    },
                    {
                      "name": "delete_time",
                      "expression": "`delete_time`"
                    },
                    {
                      "name": "tags",
                      "expression": "`tags`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "cluster_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "defaultColumnWidth": 200,
                    "displayName": "cluster_name"
                  },
                  {
                    "fieldName": "cluster_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "cluster_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_id"
                  },
                  {
                    "fieldName": "dbr_version",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "dbr_version",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "dbr_version"
                  },
                  {
                    "fieldName": "list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3,
                    "title": "list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost"
                  },
                  {
                    "fieldName": "workspace_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "workspace_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_id"
                  },
                  {
                    "fieldName": "account_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "account_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "account_id"
                  },
                  {
                    "fieldName": "owned_by",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 6,
                    "title": "owned_by",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "owned_by"
                  },
                  {
                    "fieldName": "create_time",
                    "dateTimeFormat": "DD/MM/YYYY HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 7,
                    "title": "create_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "create_time"
                  },
                  {
                    "fieldName": "delete_time",
                    "dateTimeFormat": "DD/MM/YYYY HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 8,
                    "title": "delete_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "delete_time"
                  },
                  {
                    "fieldName": "tags",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "complex",
                    "displayAs": "json",
                    "visible": true,
                    "order": 9,
                    "title": "tags",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "tags"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": true,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "DBR Version Upgrades",
                "description": "Clusters which are running on DBR versions which are no longer supported\n"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "bed86e67",
            "multilineTextboxSpec": {
              "lines": [
                "# Cluster Monitoring\n",
                "\n",
                "- High level view of All Purpose cluster spend and job runs\n",
                "- Enforcement of best practice cluster configurations"
              ]
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "33fcfea4",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "30fea210",
                  "fields": [
                    {
                      "name": "countdistinct(cluster_id)",
                      "expression": "COUNT(DISTINCT `cluster_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(cluster_id)",
                  "displayName": "Count of Unique cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total # of Clusters with No Compute Policy"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 2,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "b6fbdc29",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "f86b4fea",
                  "fields": [
                    {
                      "name": "countdistinct(cluster_id)",
                      "expression": "COUNT(DISTINCT `cluster_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(cluster_id)",
                  "displayName": "Count of Unique cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total # of Clusters with No Auto Termination Time"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 36,
            "width": 2,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "c581949a",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "328b4d25",
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    },
                    {
                      "name": "owned_by",
                      "expression": "`owned_by`"
                    },
                    {
                      "name": "list_cost",
                      "expression": "`list_cost`"
                    },
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "account_id",
                      "expression": "`account_id`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "cluster_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "defaultColumnWidth": 300,
                    "displayName": "cluster_name"
                  },
                  {
                    "fieldName": "cluster_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "cluster_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_id"
                  },
                  {
                    "fieldName": "owned_by",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "owned_by",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "owned_by"
                  },
                  {
                    "fieldName": "list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 3,
                    "title": "list_cost",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost"
                  },
                  {
                    "fieldName": "workspace_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 4,
                    "title": "workspace_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_id"
                  },
                  {
                    "fieldName": "account_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "account_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "account_id"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": true,
              "frame": {
                "showTitle": true,
                "title": "Top 10 Most Expensive Clusters with No Compute Policy"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 20,
            "width": 4,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "de4de21e",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c8471ab1",
                  "fields": [
                    {
                      "name": "countdistinct(cluster_id)",
                      "expression": "COUNT(DISTINCT `cluster_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(cluster_id)",
                  "displayName": "Count of Unique cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total # of Clusters with No Autoscaling"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 28,
            "width": 2,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "275fb0ba",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9ba49670",
                  "fields": [
                    {
                      "name": "countdistinct(cluster_id)",
                      "expression": "COUNT(DISTINCT `cluster_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(cluster_id)",
                  "displayName": "Count of Unique cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total # of Cluster with No Tag"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 44,
            "width": 2,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "67e6c893",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "d8fea384",
                  "fields": [
                    {
                      "name": "total_list_cost_usd",
                      "expression": "`total_list_cost_usd`"
                    },
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "total_list_cost_usd",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "total_list_cost_usd"
                },
                "color": {
                  "fieldName": "cluster_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Highest Cost All Purpose Clusters"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 3,
            "height": 10
          }
        },
        {
          "widget": {
            "name": "43335999",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a5cf41d7",
                  "fields": [
                    {
                      "name": "task_runs",
                      "expression": "`task_runs`"
                    },
                    {
                      "name": "job_id",
                      "expression": "`job_id`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "task_runs",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "task_runs"
                },
                "color": {
                  "fieldName": "job_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "job_id"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Highest Job Task Runs on All Purpose Clusters"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 2,
            "width": 3,
            "height": 10
          }
        },
        {
          "widget": {
            "name": "8efb21e4",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "88aeb9f4",
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    },
                    {
                      "name": "owned_by",
                      "expression": "`owned_by`"
                    },
                    {
                      "name": "total_usage_quantity",
                      "expression": "`total_usage_quantity`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "cluster_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_name"
                  },
                  {
                    "fieldName": "cluster_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "cluster_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_id"
                  },
                  {
                    "fieldName": "owned_by",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "owned_by",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "owned_by"
                  },
                  {
                    "fieldName": "total_usage_quantity",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3,
                    "title": "total_usage_quantity",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "total_usage_quantity"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": true,
              "frame": {
                "showTitle": true,
                "title": "Top 10 Most Expensive Clusters with No Autoscaling"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 28,
            "width": 4,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "850f974c",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "f8f80f40",
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    },
                    {
                      "name": "owned_by",
                      "expression": "`owned_by`"
                    },
                    {
                      "name": "total_usage_quantity",
                      "expression": "`total_usage_quantity`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "cluster_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_name"
                  },
                  {
                    "fieldName": "cluster_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "cluster_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_id"
                  },
                  {
                    "fieldName": "owned_by",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "owned_by",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "owned_by"
                  },
                  {
                    "fieldName": "total_usage_quantity",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3,
                    "title": "total_usage_quantity",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "total_usage_quantity"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": true,
              "frame": {
                "showTitle": true,
                "title": "Top 10 Most Expensive Clusters with No Auto Termination Time"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 36,
            "width": 4,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "bc59fe9d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "46ed9664",
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    },
                    {
                      "name": "owned_by",
                      "expression": "`owned_by`"
                    },
                    {
                      "name": "total_usage_quantity",
                      "expression": "`total_usage_quantity`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "cluster_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_name"
                  },
                  {
                    "fieldName": "cluster_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1,
                    "title": "cluster_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_id"
                  },
                  {
                    "fieldName": "owned_by",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2,
                    "title": "owned_by",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "owned_by"
                  },
                  {
                    "fieldName": "total_usage_quantity",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3,
                    "title": "total_usage_quantity",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "total_usage_quantity"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Top 10 Most Expensive Clusters with No Tag"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 44,
            "width": 4,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "d052ba16",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "481317e9",
                  "fields": [
                    {
                      "name": "countdistinct(cluster_id)",
                      "expression": "COUNT(DISTINCT `cluster_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(cluster_id)",
                  "displayName": "Count of Unique cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total # of Cluster with Compute Policy"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 24,
            "width": 2,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "509dec06",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "07ef34ff",
                  "fields": [
                    {
                      "name": "countdistinct(cluster_id)",
                      "expression": "COUNT(DISTINCT `cluster_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(cluster_id)",
                  "displayName": "Count of Unique cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total # of Cluster with Autoscaling"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 32,
            "width": 2,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "66df037d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "e2e14f35",
                  "fields": [
                    {
                      "name": "countdistinct(cluster_id)",
                      "expression": "COUNT(DISTINCT `cluster_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(cluster_id)",
                  "displayName": "Count of Unique cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total # of Clusters with Auto Termination Time"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 40,
            "width": 2,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "90df62d8",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "1e41ade9",
                  "fields": [
                    {
                      "name": "countdistinct(cluster_id)",
                      "expression": "COUNT(DISTINCT `cluster_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(cluster_id)",
                  "displayName": "Count of Unique cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total # of Clusters with Tag"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 48,
            "width": 2,
            "height": 4
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "0b46a280",
      "displayName": "Cluster Optimization",
      "layout": [
        {
          "widget": {
            "name": "f1a7863b",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ab02dd6c",
                  "fields": [
                    {
                      "name": "bin(Avg Worker CPU Utilization, binWidth=10)",
                      "expression": "BIN_FLOOR(`Avg Worker CPU Utilization`, 10)"
                    },
                    {
                      "name": "countdistinct(cluster_id)",
                      "expression": "COUNT(DISTINCT `cluster_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "histogram",
              "encodings": {
                "x": {
                  "fieldName": "bin(Avg Worker CPU Utilization, binWidth=10)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Avg Worker CPU Utilization"
                },
                "y": {
                  "fieldName": "countdistinct(cluster_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of Unique cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "CPU Utilization",
                "description": "Shows the average CPU utillization for all clusters"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 3,
            "height": 12
          }
        },
        {
          "widget": {
            "name": "7aecc70f",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "eab7bfd1",
                  "fields": [
                    {
                      "name": "bin(Avg Worker Memory Utilization, binWidth=10)",
                      "expression": "BIN_FLOOR(`Avg Worker Memory Utilization`, 10)"
                    },
                    {
                      "name": "countdistinct(cluster_id)",
                      "expression": "COUNT(DISTINCT `cluster_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "histogram",
              "encodings": {
                "x": {
                  "fieldName": "bin(Avg Worker Memory Utilization, binWidth=10)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Avg Worker Memory Utilization"
                },
                "y": {
                  "fieldName": "countdistinct(cluster_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Count of Unique cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Memory Utilization",
                "description": "Shows the average CPU utillization for all clusters"
              },
              "mark": {
                "colors": [
                  {
                    "themeColorType": "visualizationColors",
                    "position": 2
                  },
                  {
                    "themeColorType": "visualizationColors",
                    "position": 2
                  },
                  {
                    "themeColorType": "visualizationColors",
                    "position": 3
                  },
                  {
                    "themeColorType": "visualizationColors",
                    "position": 4
                  },
                  {
                    "themeColorType": "visualizationColors",
                    "position": 5
                  },
                  {
                    "themeColorType": "visualizationColors",
                    "position": 6
                  },
                  {
                    "themeColorType": "visualizationColors",
                    "position": 7
                  },
                  {
                    "themeColorType": "visualizationColors",
                    "position": 8
                  },
                  {
                    "themeColorType": "visualizationColors",
                    "position": 9
                  },
                  {
                    "themeColorType": "visualizationColors",
                    "position": 10
                  }
                ]
              }
            }
          },
          "position": {
            "x": 3,
            "y": 8,
            "width": 3,
            "height": 12
          }
        },
        {
          "widget": {
            "name": "92da33f4",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9247958f",
                  "fields": [
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    },
                    {
                      "name": "Avg CPU Utilization",
                      "expression": "`Avg CPU Utilization`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "cluster_id",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "y"
                    }
                  },
                  "axis": {
                    "hideLabels": true
                  },
                  "displayName": "cluster_id"
                },
                "y": {
                  "fieldName": "Avg CPU Utilization",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideLabels": false
                  },
                  "displayName": "Avg CPU Utilization"
                },
                "color": {
                  "fieldName": "cluster_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Top 10 Lowest CPU Utillization",
                "description": "Top 10 clusters with the lowest CPU utilization rates"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 3,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "b6a517a3",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "6d62f41d",
                  "fields": [
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    },
                    {
                      "name": "Avg CPU Utilization",
                      "expression": "`Avg CPU Utilization`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "cluster_id",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "y-reversed"
                    }
                  },
                  "axis": {
                    "hideLabels": true
                  },
                  "displayName": "cluster_id"
                },
                "y": {
                  "fieldName": "Avg CPU Utilization",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Avg CPU Utilization"
                },
                "color": {
                  "fieldName": "cluster_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "cluster_id"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Top 10 Highest Memory Utililzation",
                "description": "Top 10 clusters with the highest memory utilization rates"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 20,
            "width": 3,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "f2c2e793",
            "multilineTextboxSpec": {
              "lines": [
                "## Best Practice Optimizations\n",
                "\n",
                "[Compute Configuration Recommendations](https://docs.databricks.com/aws/en/compute/cluster-config-best-practices)                 \n",
                "[Cost Optimization Best Practices](https://docs.databricks.com/aws/en/lakehouse-architecture/cost-optimization/best-practices)\n",
                "\n",
                "- For workloads which have unbalanced CPU vs memory utilization, consider switching to more **CPU/memory instances**\n",
                "- **Tuning min vs max workers**\n",
                "    - Never choose a single worker for a production job as it will be a single point of failure\n",
                "    - Start with 2-4 workers for small workloads (e.g. a job with no wide transformations like joins or aggregations)\n",
                "    - Start with 8-10 workers for medium to big workloads with wide transformations, then scale up if necessary Photon - mostly benefits CPU throughput, won't have benefits if bottleneck isn't CPU \n",
                "- **Disk utilization bottlenecks** - memory swap, spill, skew, etc.\n",
                "- Consider Photon effectiveness on workloads with high memory utilization where the full benefits may not be realized"
              ]
            }
          },
          "position": {
            "x": 0,
            "y": 3,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "1f01bdc1",
            "multilineTextboxSpec": {
              "lines": [
                "# Cluster Optimizations\n",
                "\n",
                "- Jobs to cluster mapping\n",
                "- Cluster CPU and memory utilization\n",
                "- All purpose to jobs cluster migration opportunities\n",
                "- Outdated instance type upgrades"
              ]
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "40209aaf",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "7880d910",
                  "fields": [
                    {
                      "name": "cluster_link",
                      "expression": "`cluster_link`"
                    },
                    {
                      "name": "avg_memory_swap",
                      "expression": "`avg_memory_swap`"
                    },
                    {
                      "name": "peak_memory_swap",
                      "expression": "`peak_memory_swap`"
                    },
                    {
                      "name": "observation_count",
                      "expression": "`observation_count`"
                    },
                    {
                      "name": "list_cost",
                      "expression": "`list_cost`"
                    },
                    {
                      "name": "owned_by",
                      "expression": "`owned_by`"
                    },
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "account_id",
                      "expression": "`account_id`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_link",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "cluster_link",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "defaultColumnWidth": 300,
                    "displayName": "cluster_link"
                  },
                  {
                    "fieldName": "avg_memory_swap",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100001,
                    "title": "avg_memory_swap",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "avg_memory_swap"
                  },
                  {
                    "fieldName": "peak_memory_swap",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100002,
                    "title": "peak_memory_swap",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "peak_memory_swap"
                  },
                  {
                    "fieldName": "observation_count",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100003,
                    "title": "observation_count",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "observation_count"
                  },
                  {
                    "fieldName": "list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "list_cost",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost"
                  },
                  {
                    "fieldName": "owned_by",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100005,
                    "title": "owned_by",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "owned_by"
                  },
                  {
                    "fieldName": "workspace_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100006,
                    "title": "workspace_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_id"
                  },
                  {
                    "fieldName": "account_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100007,
                    "title": "account_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "account_id"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": true,
              "frame": {
                "showTitle": true,
                "title": "Top 10 High Memory Swap Clusters"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 40,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "53f83414",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "97da2baf",
                  "fields": [
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "name",
                      "expression": "`name`"
                    },
                    {
                      "name": "Avg CPU Utilization",
                      "expression": "`Avg CPU Utilization`"
                    },
                    {
                      "name": "Peak CPU Utilization",
                      "expression": "`Peak CPU Utilization`"
                    },
                    {
                      "name": "Avg CPU Disk Wait",
                      "expression": "`Avg CPU Disk Wait`"
                    },
                    {
                      "name": "Max CPU Disk Wait",
                      "expression": "`Max CPU Disk Wait`"
                    },
                    {
                      "name": "Avg Memory Utilization",
                      "expression": "`Avg Memory Utilization`"
                    },
                    {
                      "name": "Max Memory Utilization",
                      "expression": "`Max Memory Utilization`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "workspace_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_id"
                  },
                  {
                    "fieldName": "name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "name"
                  },
                  {
                    "fieldName": "Avg CPU Utilization",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100002,
                    "title": "Avg CPU Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Avg CPU Utilization"
                  },
                  {
                    "fieldName": "Peak CPU Utilization",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100003,
                    "title": "Peak CPU Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Peak CPU Utilization"
                  },
                  {
                    "fieldName": "Avg CPU Disk Wait",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100004,
                    "title": "Avg CPU Disk Wait",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Avg CPU Disk Wait"
                  },
                  {
                    "fieldName": "Max CPU Disk Wait",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "Max CPU Disk Wait",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Max CPU Disk Wait"
                  },
                  {
                    "fieldName": "Avg Memory Utilization",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "Avg Memory Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Avg Memory Utilization"
                  },
                  {
                    "fieldName": "Max Memory Utilization",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "Max Memory Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Max Memory Utilization"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Top 10 Lowest CPU Utilization Jobs"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 28,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "321e26b7",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a55f1589",
                  "fields": [
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "name",
                      "expression": "`name`"
                    },
                    {
                      "name": "Avg CPU Utilization",
                      "expression": "`Avg CPU Utilization`"
                    },
                    {
                      "name": "Peak CPU Utilization",
                      "expression": "`Peak CPU Utilization`"
                    },
                    {
                      "name": "Avg CPU Disk Wait",
                      "expression": "`Avg CPU Disk Wait`"
                    },
                    {
                      "name": "Max CPU Disk Wait",
                      "expression": "`Max CPU Disk Wait`"
                    },
                    {
                      "name": "Avg Memory Utilization",
                      "expression": "`Avg Memory Utilization`"
                    },
                    {
                      "name": "Max Memory Utilization",
                      "expression": "`Max Memory Utilization`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "workspace_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_id"
                  },
                  {
                    "fieldName": "name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "name"
                  },
                  {
                    "fieldName": "Avg CPU Utilization",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100002,
                    "title": "Avg CPU Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Avg CPU Utilization"
                  },
                  {
                    "fieldName": "Peak CPU Utilization",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100003,
                    "title": "Peak CPU Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Peak CPU Utilization"
                  },
                  {
                    "fieldName": "Avg CPU Disk Wait",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100004,
                    "title": "Avg CPU Disk Wait",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Avg CPU Disk Wait"
                  },
                  {
                    "fieldName": "Max CPU Disk Wait",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "Max CPU Disk Wait",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Max CPU Disk Wait"
                  },
                  {
                    "fieldName": "Avg Memory Utilization",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "Avg Memory Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Avg Memory Utilization"
                  },
                  {
                    "fieldName": "Max Memory Utilization",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "Max Memory Utilization",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Max Memory Utilization"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Top 10 Highest Memory Utilization Jobs"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 34,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "e8d11052",
            "queries": [
              {
                "name": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05bcbfc891a348145936f968b6d41_cluster_id",
                "query": {
                  "datasetName": "eab7bfd1",
                  "fields": [
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    },
                    {
                      "name": "cluster_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "cluster_id",
                    "displayName": "cluster_id",
                    "queryName": "dashboards/01f05b82a5d013e3892a3baf5d2b41aa/datasets/01f05bcbfc891a348145936f968b6d41_cluster_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "c94b094e",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "d13ce183",
                  "fields": [
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    },
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "task_runs",
                      "expression": "`task_runs`"
                    },
                    {
                      "name": "list_cost",
                      "expression": "`list_cost`"
                    },
                    {
                      "name": "jobs_list",
                      "expression": "`jobs_list`"
                    },
                    {
                      "name": "last_seen_date",
                      "expression": "`last_seen_date`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "workspace_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "workspace_id"
                  },
                  {
                    "fieldName": "cluster_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "cluster_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_id"
                  },
                  {
                    "fieldName": "cluster_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "cluster_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_name"
                  },
                  {
                    "fieldName": "task_runs",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100003,
                    "title": "task_runs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "task_runs"
                  },
                  {
                    "fieldName": "list_cost",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100004,
                    "title": "list_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "list_cost"
                  },
                  {
                    "fieldName": "jobs_list",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "complex",
                    "displayAs": "json",
                    "visible": true,
                    "order": 100005,
                    "title": "jobs_list",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "jobs_list"
                  },
                  {
                    "fieldName": "last_seen_date",
                    "dateTimeFormat": "DD/MM/YYYY HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100006,
                    "title": "last_seen_date",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "last_seen_date"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "All Purpose Clusters with Highest Job Run Frequency Last 30 Days"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 46,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "50a5af3d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "8bc2bb84",
                  "fields": [
                    {
                      "name": "worker_node_type",
                      "expression": "`worker_node_type`"
                    },
                    {
                      "name": "sum(usage_quantity)",
                      "expression": "SUM(`usage_quantity`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "worker_node_type",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "y-reversed"
                    }
                  },
                  "displayName": "worker_node_type"
                },
                "y": {
                  "fieldName": "sum(usage_quantity)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of usage_quantity"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Outdated Instance Types Worker Nodes"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 52,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "3c0065a7",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "8bc2bb84",
                  "fields": [
                    {
                      "name": "driver_node_type",
                      "expression": "`driver_node_type`"
                    },
                    {
                      "name": "sum(usage_quantity)",
                      "expression": "SUM(`usage_quantity`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "driver_node_type",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "y-reversed"
                    }
                  },
                  "displayName": "driver_node_type"
                },
                "y": {
                  "fieldName": "sum(usage_quantity)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Sum of usage_quantity"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Outdated Instance Types Driver Nodes"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 52,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "32e25964",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "8bc2bb84",
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "record_id",
                      "expression": "`record_id`"
                    },
                    {
                      "name": "cluster_id",
                      "expression": "`cluster_id`"
                    },
                    {
                      "name": "owned_by",
                      "expression": "`owned_by`"
                    },
                    {
                      "name": "driver_node_type",
                      "expression": "`driver_node_type`"
                    },
                    {
                      "name": "worker_node_type",
                      "expression": "`worker_node_type`"
                    },
                    {
                      "name": "change_time",
                      "expression": "`change_time`"
                    },
                    {
                      "name": "usage_start_time",
                      "expression": "`usage_start_time`"
                    },
                    {
                      "name": "usage_quantity",
                      "expression": "`usage_quantity`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "cluster_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": true,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_name"
                  },
                  {
                    "fieldName": "record_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "record_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "record_id"
                  },
                  {
                    "fieldName": "cluster_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "cluster_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "cluster_id"
                  },
                  {
                    "fieldName": "owned_by",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "owned_by",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "owned_by"
                  },
                  {
                    "fieldName": "driver_node_type",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "driver_node_type",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "driver_node_type"
                  },
                  {
                    "fieldName": "worker_node_type",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100005,
                    "title": "worker_node_type",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "worker_node_type"
                  },
                  {
                    "fieldName": "change_time",
                    "dateTimeFormat": "DD/MM/YYYY HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100006,
                    "title": "change_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "change_time"
                  },
                  {
                    "fieldName": "usage_start_time",
                    "dateTimeFormat": "DD/MM/YYYY HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100007,
                    "title": "usage_start_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "usage_start_time"
                  },
                  {
                    "fieldName": "usage_quantity",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100008,
                    "title": "usage_quantity",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "usage_quantity"
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Outdated Instance Types"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 58,
            "width": 6,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    }
  ],
  "uiSettings": {
    "theme": {
      "widgetHeaderAlignment": "ALIGNMENT_UNSPECIFIED"
    }
  }
}

